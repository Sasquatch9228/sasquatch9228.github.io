<!DOCTYPE html>
<html>
    <head>
        <title>SH1MMER Unenrollment Exploit - Chrome OS Exploits</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" href="../../assets/icon.png">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans">
        <link rel="stylesheet" href="../../main.css">
        <link rel="stylesheet" href="../detail.css">
        <script src="../addheader.js"></script>
        <script>
            window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
            ga('create', 'UA-XXXXX-Y', 'auto');
            ga('send', 'pageview');
        </script>
    <meta name="google-site-verification" content="weY0_IfasLpB3jj53TSPZIfHSBY2obh-2hIuFTVIrhw" /></head>
    <body>
        <div id="main-content">
        <h3>
            <image height="20px" src="assets/icon.png"></image>
            <span class="title">SH1MMER Unenrollment Exploit</span>
            <br>
            <small>Mercury Workshop</small>
            <p>
            <a href="https://sh1mmer.me" target="_blank">
                <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-link flex-shrink-0 mr-2">
                    <path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path>
                </svg>
                Website
            </a>
            <a href="https://github.com/MercuryWorkshop/sh1mmer" target="_blank">
                <svg width="16" viewBox="0 0 16 16">
                    <path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"></path>
                </svg>
                GitHub
            </a>
        </h3>
        Shim downloading has been taken down by Google. Use <a target="_blank" href="https://dl.osu.bio">this rehosted link</a> to get a shim for your Chromebook's board.
        <h2>Shady Hardware 1nstrument Makes Machine Enrollment Retreat</h2>
        SH1MMER is an exploit capable of completely unenrolling enterprise-managed Chromebooks. It was found by the Mercury Workshop team and was released on <u>January, Friday the 13th, 2023<u>. For more information, check out the <a href="https://coolelectronics.me/blog/breaking-cros-2">Writeup</a>.
    </p>
        <p>
        <b>If this isn't working for you, check "The Fog" section below.</b>
        <h3>What you will need</h3>
        A USB with at least 1GB of storage
        <p>
        A personal computer or Chromebook; note that you do need administrator permissions on Windows/MacOS
        <h3>Writing to USB</h3>
        First, you'll need to find your managed Chromebook's board name. This can be done by going to <u>chrome://version</u> on your Chromebook and copying the word after stable-channel, or with a variety of other methods.
        <p>
        Alternate Method: Press <u>Esc + Refresh + Power</u> to enter Recovery Mode, and look up your codename on https://cros.tech/. Click your device, and your board name will be shown. Note that GRABBITER is the same as FLEEX (which is octopus) but is not shown on most online databases.
        <p>
        If your board name is in the list below, your board has a publicly leaked RMA shim. If it's not, you'll have to source it on your own.
        <p>
        brask, brya, clapper, coral, corsola, dedede, enguarde, glimmer, grunt, hana, hatch, jacuzzi, kukui, nami, octopus, orco, pyro, reks, sentry, stout, strongbad, tidus, ultima, volteer, zork
        <p>
        First you need to download a SH1MMER bin. Download a shim at dl.sh1mmer.me, and build it with the <a href="https://sh1mmer.me/builder.html" target="_self">SH1MMER Web Builder</a>.
        <p>
        You can also use the desktop version of wax for linux/WSL, located in the <a href="https://github.com/MercuryWorkshop/sh1mmer">GitHub</a> repository.
        <p>
        Once you've obtained a MODIFIED/INJECTED SHIM (NOT A RAW SHIM), you can continue.
        <p>
        Download the <a href="https://chrome.google.com/webstore/detail/pocpnlppkickgojjlmhdmidojbmbodfm">Chromebook Recovery Utility extension</a> on your personal computer as well.
        <p>
        Once the downloads are complete, launch the recovery utility by clicking the extensions icon in Chrome, then click the Chromebook Recovery Utility, and plug your USB drive into your personal computer.
        <p>
        IMPORTANT NOTE: Your USB drive will be completely cleared and partitioned.
        <p>
        In the recovery utility window, click the settings icon and press "Use local image".
        <p>
        Select your shim file, identify your USB drive, and start the writing process.  This can take anywhere between 30 seconds and 20 minutes, depending on the speed of your USB drive.
        <p> 
        You can also use tools such as Rufus, BalenaEtcher, etc, to flash on Windows. If you are on Linux, <u>dd</u> is recommended.
        <h3>Executing on Chromebook</h3>
        Once writing is complete, enter recovery mode on your Chromebook. This is done by pressing the power button (⏻), reload key (↻), and escape key at the same time. Your screen should look one of the images below:
        <p>
        Press Ctrl+D on this screen, then press enter.
        <p>
        It will now say something about "<em>confirm returning to secure mode</em>" or that "<em>OS verification is off</em>". You will most likely not actually be in developer mode, but the exploit will work regardless. Your screen should look like one of the images below:
        <p>
        On this screen, press the power button (⏻), reload key (↻), and ESC key at the same time again! This is very important and cannot be skipped.
        <p>
        Once it re-shows the original recovery screen, plug your shimmed USB into your Chromebook, and press the power button (⏻), reload key (↻), and ESC key again. After a brief black-and-white loading screen, you should be in the SH1MMER menu.
        <p>
        Play around with the UI, exit, and reboot.
        <h3>The Fog</h3>
        <em>(Google's response, and why this might not be working for you)</em>
        <p>
        Downgrading and unenrollment has been patched by Google. If your Chromebook has never updated to version 112 before (check in <u>chrome://version</u>), you can ignore this and follow the regular instructions. If not, unenrollment will not work as normal. If you aren't willing to take apart your Chromebook to unenroll, you can use an affiliated project, <a href="https://fog.gay">E-HALCYON</a> to boot into a deprovisioned environment temporarily.
        <h3>How to use the SH1MMER exploit on version 111 → version 113</h3>
        <em>(if you're willing to take the back cover off your Chromebook)</em>
        <p>
        You only need to do this once, and it will let you use the SH1MMER exploit even after it's been completely patched.
        <ol>
            <li>Unplug everything, open the back panel, disconnect the battery to disable WP, plug in the charger</li>
            <li>Boot into SH1MMER and use "Un-Enroll / Deprovision" (yes it will show an error, but that doesn't matter)<p>(you will also need to run "<code>Disable block_devmode</code>" if you're using the old legacy version)</li>
            <li>Go to the bash shell and run this command:<code>/usr/share/vboot/bin/set_gbb_flags.sh 0x8090</code>Do not use "<code>Reset GBB Flags</code>" after this.</li>
            <li>Exit SH1MMER, unplug everything, reconnect the battery, and reconnect the charger.</li>
            <li>Boot up and press Ctrl+D to enter developer mode.</li>
            <li>When completed, use Ctrl+ALT+SHIFT+R to powerwash</li>
            <li>After powerwashing, immediately enter VT2 with Ctrl+Alt+F2 (→), login as "<code>root</code>" and run these commands:<code>tpm_manager_client take_ownership<p>cryptohome --action=remove_firmware_management_parameters</code>If it fails, try downgrading to version 110 if possible. If you cannot do so, use E-Halcyon instead.<li>Press Ctrl+Alt+F1 (←), and use Ctrl+Alt+Shift+R to powerwash the Chromebook again.</li>
        </ol>
        <b>NOTE:</b> If you have a <code>dedede</code> board, your WP method is probably different. Look your model up online to find the WP method.
        <h3>What now?</h3>
        You will now be able to, among other things, unenroll your Chromebook. It will now behave entirely as if it is a personal computer and no longer contain spyware or blocker extensions. After you do this and get past the "determining device configuration" screen, you will be able to actually turn developer mode on.
        <p>
        Note that while unenrolled, it is recommended to add your personal account first, then add your school account, then switch between the two accounts as needed. Mercury Workshop does not condone the use of SH1MMER or unenrolling to cheat or plagiarize in school.
        <p>
        The biggest challenges with unenrolling are connecting to the school network and taking state or national exams (since there are no kiosk applications anymore).
        <p>
        There are many methods to get a school Wi-Fi password while enrolled, including the policy netlog trick found by Luphoria. While on a school account and unenrolled, you can bypass Wi-Fi blocks by using a secure DNS such as Cloudflare 1.1.1.1 from <u>chrome://os-settings/osPrivacy</u>. It is also recommended to enable "<em>MAC Address Randomization</em>" in <u>chrome://flags</u> to stay hidden.
        <p>
        To take a kiosk exam, the safest option is to re-enroll back temporarily. Instructions for doing that are hosted at <a href="https://sh1mmer.me/kiosks.txt" target="_blank">kiosks.txt</a>. Saving a copy of this text file for future reference is probably a smart move to do.
        <p>
        You can also use <a href="https://github.com/MercuryWorkshop/fakemurk">fakemurk</a> as a way to enroll your device but stay in developer mode and have control over policies and extensions. You may need to use this to get Wi-Fi passwords if <u>chrome://net-export</u> is blocked.
        </div>
    </body>
</html>
